# Backend Execution Flow: From Frontend Actions to Database Operations

### How requests or data travel from user clicks/frontend all the way to backend and get fulfilled

---

## 1. How the front end gets data: planets and launches (GET Request)

- The `usePlanets` and `useLaunches` custom hooks are responsible for fetching data. (This data is then loaded into `AppLayout` and passed down to other components.)
- How do they fetch data?
  - By calling `httpGetLaunches()` and `httpGetPlanets()` inside `requests.js`, which hit the API endpoints with the GET method.
  - So the request originates in the custom hook, travels to `requests.js`, then to the appropriate function, and finally hits the API endpoint.
- **Backend journey:**
  - The request reaches `server.js` → `app.js` → `api.js`
  - Then it goes to the appropriate router file (based on `"/launches"` or `"/planets"`)
  - Then to the proper route inside that router
  - Finally, it lands in the controller function
- **Controller role:**
  - The controller receives the request
  - Calls the model (which is in charge of data)
  - Using the appropriate model function, fetches data from the database and fulfills the request

**Diagram:**

```

Frontend (usePlanets / useLaunches) → requests.js → API function → API endpoint
→ server.js → app.js → api.js → router → route → controller → model → database → response

```

---

## 2. How data collected through launches form is sent to backend (POST request)

- User fills out a form → triggers `submitLaunch()` on `onsubmit`
- `submitLaunch()` is inside `useLaunches` and internally uses `requests.js`'s `httpsubmitLaunch()`
- The form data is now in `httpsubmitLaunch()`
  - It puts the data inside the request object and sends a POST request to the API endpoint `"/launches"`
- **Backend journey:**
  - Data in `req.body` travels to `server.js` → `app.js` → `api.js`
  - Goes to the appropriate router file (`launches`, since endpoint is `"/launches"` and method is POST)
  - Then to the proper route inside the router
  - Finally reaches the controller function
- **Controller role:**
  - Extracts data from `req.body`
  - Calls the model (which is in charge of data)
  - Calls the appropriate model function
  - Stores the data in the database at the appropriate location inside the collection

**Diagram:**

```

Form → submitLaunch() → useLaunches → requests.js → httpsubmitLaunch() → POST "/launches"
→ server.js → app.js → api.js → launches router → route → controller → model → database → response

```

---

## 3. How abort (DELETE) request is sent to backend (DELETE Request)

- User clicks `X` → triggers `abortLaunch()` by taking launch ID with it
- `abortLaunch()` is inside `useLaunches` and internally calls `requests.js`'s `httpabortLaunch()`
- The ID and the request travel to `httpabortLaunch()`
  - it puts the id inside the request object and sends a DELETE request to the appropriate endpoint
- **Backend journey:**
  - Request and data travels to `server.js` → `app.js` → `api.js`
  - Goes to the appropriate router file (`launches` in this case)
  - Then to the proper route in that router
  - Finally reaches the controller function
- **Controller role:**
  - Extracts ID from `req.body`
  - Calls the model (which is in charge of data)
  - Uses the appropriate model function to delete the launch from the database using its id.

**Diagram:**

```

Click "X" → abortLaunch() → useLaunches → requests.js → httpabortLaunch() → DELETE "/launches"
→ server.js → app.js → api.js → launches router → route → controller → model → database → response

```

```

```


%% 1. Frontend GET Data (Planets & Launches)
flowchart TD
    A[Frontend Component\nAppLayout / Child Components] --> B[Custom Hook\nusePlanets / useLaunches]
    B --> C[Requests.js Function\nhttpGetPlanets / httpGetLaunches]
    C --> D[API Endpoint\nGET "/planets" / "/launches"]
    D --> E[Server Layer\nserver.js → app.js → api.js]
    E --> F[Router File\nplanetsRouter / launchesRouter]
    F --> G[Route in Router\nmatches GET route]
    G --> H[Controller Function\ngetPlanets() / getLaunches()]
    H --> I[Model Function\nfetchPlanetsFromDB() / fetchLaunchesFromDB()]
    I --> J[Database\nreturns requested data]
    J --> K[Controller returns response\nto frontend hook]
    K --> L[Custom Hook updates state\nComponents render data]
